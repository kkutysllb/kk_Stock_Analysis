# 自适应提示词系统使用说明

## 概述

自适应提示词系统是一个智能的AI提示词管理工具，能够根据用户选择的功能配置和数据上下文，自动生成最适合的提示词模板，并传递给AI模型进行分析。

## 主要功能

### 1. 功能配置自适应

系统会根据以下配置选项自动调整提示词：

- **智能分析开关**: 控制是否启用深度分析功能
- **内容优化**: 控制回答的结构化程度和专业术语解释
- **分析频率**: 
  - `realtime`: 实时分析，关注短期趋势
  - `daily`: 日度分析，关注当日策略
  - `weekly`: 周度分析，关注中长期投资
- **准确度要求**:
  - `high`: 详细数据支撑，多维度分析
  - `balanced`: 平衡分析深度和效率
  - `fast`: 快速核心观点，简洁明了

### 2. 数据上下文增强

当AI组件接收到数据上下文时，系统会自动增强提示词：

- 数据类型（如：股票日线数据、ETF数据等）
- 数据名称（如：平安银行(000001)）
- 时间周期（如：2024年1月-12月）
- 数据摘要（如：全年涨幅15.2%）
- 具体数据内容

## 使用方法

### 1. 配置功能选项

在设置页面的"功能配置"部分：

1. 根据需要开启或关闭"智能分析"
2. 选择是否启用"内容优化"
3. 设置"分析频率"（实时分析/每日分析/每周分析）
4. 选择"准确度要求"（高精度/平衡模式/快速模式）

### 2. 应用系统提示词

配置完成后：

1. 点击"查看系统提示词"预览生成的提示词
2. 点击"应用系统提示词"保存配置
3. 点击"测试自适应效果"查看不同配置的效果对比

### 3. AI调用时的自动适应

当使用AI问答功能时，系统会：

1. 自动加载已保存的功能配置
2. 结合当前数据上下文生成增强提示词
3. 将优化后的提示词传递给AI模型
4. 确保AI回答更加精准和相关

## 配置示例

### 高频交易场景
```
智能分析: 开启
内容优化: 开启
分析频率: 实时分析
准确度要求: 高精度
```
生成的提示词将重点关注实时市场动态和短期趋势变化。

### 长期投资场景
```
智能分析: 开启
内容优化: 开启
分析频率: 每周分析
准确度要求: 高精度
```
生成的提示词将重点关注周期性趋势和中长期投资机会。

### 快速查询场景
```
智能分析: 关闭
内容优化: 关闭
分析频率: 每日分析
准确度要求: 快速模式
```
生成的提示词将提供快速、简洁的核心信息。

## 技术实现

### 核心文件

- `aiPromptManager.ts`: 提示词管理核心逻辑
- `Settings.vue`: 配置界面和功能控制
- `AskAIComponent.vue`: AI调用组件，自动使用自适应提示词
- `testAdaptivePrompts.ts`: 测试工具，验证不同配置效果

### 主要函数

- `generateSystemPromptFromConfig()`: 根据配置生成基础提示词
- `getCurrentSystemPrompt()`: 获取增强后的系统提示词
- `getAIMessages()`: 构建完整的AI消息数组
- `updateSystemPrompt()`: 保存和更新提示词配置

## 最佳实践

1. **根据使用场景选择合适的配置**：短期交易选择实时+高精度，长期投资选择周度+高精度
2. **定期测试不同配置效果**：使用"测试自适应效果"功能对比不同配置
3. **关注数据上下文**：确保传递给AI的数据信息完整准确
4. **监控AI回答质量**：根据实际效果调整配置参数

## 故障排除

### 常见问题

1. **提示词未生效**：检查是否点击了"应用系统提示词"按钮
2. **AI回答不够精准**：尝试调整准确度要求或启用内容优化
3. **响应速度慢**：选择快速模式或关闭部分分析功能

### 调试方法

1. 使用"测试自适应效果"功能查看生成的提示词
2. 检查浏览器控制台的日志输出
3. 验证AI配置是否正确（API地址、密钥等）

通过合理配置和使用自适应提示词系统，可以显著提升AI分析的准确性和相关性，为用户提供更好的量化分析体验。